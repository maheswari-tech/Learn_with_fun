<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Learn with Fun - Profile</title>
    <style>
        /* Your existing CSS remains unchanged */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        }

        body {
            background-image: linear-gradient(to right, indigo, violet);
            color: white;
            min-height: 100vh;
        }

        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 40px;
        }

        .logo {
            display: flex;
            align-items: center;
            color: white;
            text-decoration: none;
        }

        .logo-text {
            font-size: 18px;
            font-weight: 500;
            line-height: 1.2;
        }

        .nav-links {
            display: flex;
            gap: 40px;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            opacity: 0.8;
            font-size: 16px;
        }

        .dashboard-btn {
            background-color: #2a3547;
            color: white;
            border: none;
            border-radius: 20px;
            padding: 10px 25px;
            font-size: 16px;
            cursor: pointer;
        }

        .content {
            display: flex;
            justify-content: space-between;
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px;
        }

        .profile-section {
            margin-top: 80px;
        }

        .profile-title {
            font-size: 64px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .profile-subtitle {
            font-size: 28px;
            opacity: 0.8;
            margin-bottom: 20px;
        }

        .profile-details {
            background-color: transparent;
            border-radius: 8px;
            padding: 30px;
            width: 500px;
            box-shadow: 0px 4px 15px rgba(0, 0, 0, 0.3);
        }

        .details-title {
            font-size: 24px;
            font-weight: 500;
            margin-bottom: 25px;
        }

        .detail-row {
            display: flex;
            margin-bottom: 15px;
        }

        .detail-label {
            margin-right: 5px;
            font-weight: 500;
        }

        .detail-value {
            opacity: 0.9;
        }

        .divider {
            height: 1px;
            background-color: rgba(255, 255, 255, 0.2);
            margin: 25px 0;
        }

        .scoreboard-title {
            font-size: 24px;
            font-weight: 500;
            margin-bottom: 20px;
        }

        .subject-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid #6c5ce7;
        }

        .subject-title {
            font-weight: 600;
            margin-bottom: 10px;
            color: white;
        }

        .progress-container {
            width: 100%;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            margin: 15px 0;
            height: 20px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #6c5ce7, #a29bfe);
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        .progress-details {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.8);
        }

        .visualization-btn {
            background-color: #993aff;
            color: white;
            border: none;
            border-radius: 20px;
            padding: 10px 0;
            width: 90%;
            font-size: 16px;
            cursor: pointer;
            display: block;
            margin: 25px auto 0;
        }

        .encouragement {
            font-size: 16px;
            opacity: 0.7;
            margin-top: 20px;
        }

        .logo-img {
            width: 60px;
            height: 60px;
            margin-right: 10px;
        }

        /* AI Tutor Styles */
        #ai-tutor-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 10px;
            transition: all 0.3s;
        }
        
        #ai-tutor {
            width: 120px;
            height: 120px;
            background-image: url('data:image/jpeg;base64,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');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            cursor: pointer;
            transition: all 0.3s;
            animation: float 3s ease-in-out infinite;
            filter: drop-shadow(0 5px 10px rgba(0,0,0,0.3));
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        #ai-tutor:hover {
            transform: scale(1.05);
        }
        
        #ai-speech-bubble {
            background-color: white;
            padding: 15px;
            border-radius: 20px;
            max-width: 250px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            position: relative;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s;
            font-size: 16px;
            color: #073B4C;
        }
        
        #ai-speech-bubble::after {
            content: '';
            position: absolute;
            bottom: -10px;
            right: 30px;
            border-width: 10px 10px 0;
            border-style: solid;
            border-color: white transparent transparent;
        }
        
        #ai-speech-bubble.show {
            opacity: 1;
            transform: translateY(0);
        }

        /* Guidance Styles */
        .guidance-highlight {
            animation: pulse 2s infinite;
            position: relative;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(247, 169, 28, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(247, 169, 28, 0); }
            100% { box-shadow: 0 0 0 0 rgba(247, 169, 28, 0); }
        }

        .guidance-arrow {
            position: absolute;
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-bottom: 15px solid white;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            filter: drop-shadow(0 2px 2px rgba(0,0,0,0.3));
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <a href="/home.html" class="logo">
            <svg class="logo-img" viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 32C12 22.059 20.059 14 30 14C39.941 14 48 22.059 48 32" stroke="white" stroke-width="2"/>
                <path d="M31.5 25L31.5 35" stroke="white" stroke-width="2"/>
                <path d="M26.5 30L36.5 30" stroke="white" stroke-width="2"/>
                <path d="M20 40L40 40" stroke="white" stroke-width="2"/>
            </svg>
            <div class="logo-text">Learn<br>with Fun</div>
        </a>
        <div class="nav-links">
            <a href="#">About</a>
            <a href="#">Academy</a>
            <a href="#">Features</a>
            <a href="/profile.html">Profile</a>
        </div>
        <button class="dashboard-btn" onclick="window.location.href='/home.html'">Dashboard</button>
    </nav>

    <div class="content">
        <div class="profile-section">
            <h1 class="profile-title">Your Profile</h1>
            <h2 class="profile-subtitle" id="username">Loading...</h2>
            <p class="encouragement">Keep going up!</p>
        </div>

        <div class="profile-details">
            <h3 class="details-title">Personal Details</h3>
            
            <div class="detail-row">
                <span class="detail-label">Name:</span>
                <span class="detail-value" id="detail-username">Loading...</span>
            </div>
            
            <div class="detail-row">
                <span class="detail-label">Standard:</span>
                <span class="detail-value" id="detail-standard">Loading...</span>
            </div>
            
            <div class="detail-row">
                <span class="detail-label">Age:</span>
                <span class="detail-value" id="detail-age">Loading...</span>
            </div>
            
            <div class="detail-row">
                <span class="detail-label">School:</span>
                <span class="detail-value" id="detail-school">Loading...</span>
            </div>
            
            <div class="detail-row">
                <span class="detail-label">Medium:</span>
                <span class="detail-value" id="detail-medium">Loading...</span>
            </div>
            
            <div class="divider"></div>
            
            <h3 class="scoreboard-title">Score Board</h3>
            <div id="subject-scores">
                <!-- Scores will be dynamically inserted here -->
            </div>
            
            <button class="visualization-btn" id="visualizationBtn">Visualization</button>
        </div>
    </div>

    <!-- AI Tutor Section -->
    <div id="ai-tutor-container">
        <div id="ai-speech-bubble"></div>
        <div id="ai-tutor"></div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', async function() {
            const userId = localStorage.getItem('userId');
            const username = localStorage.getItem('username');
            console.log('Retrieved userId from localStorage:', userId);

            if (!userId) {
                console.log('No userId found, redirecting to login');
                alert('Please log in to view your profile');
                window.location.href = '/login.html';
                return;
            }

            // AI Tutor functionality
            const tutorMessages = {
                welcome: `Hello ${username || 'there'}! I'm here to help you understand your profile.`,
                profileDetails: "This section shows your personal information and learning details.",
                scoreboard: "Here you can see your progress in different subjects.",
                visualization: "Click the Visualization button to see your progress in charts!",
                dashboard: "Go back to Dashboard to continue learning with fun games!",
                profileNav: "You're currently viewing your profile details.",
                encouragement: "Great progress! Keep up the good work!"
            };

            // Speak a message from the AI tutor
            function tutorSpeak(message, duration = 5000) {
                const speechBubble = document.getElementById('ai-speech-bubble');
                speechBubble.innerHTML = message + '<div class="guidance-arrow"></div>';
                speechBubble.classList.add('show');
                
                // Use speech synthesis if available
                if ('speechSynthesis' in window) {
                    const utterance = new SpeechSynthesisUtterance(message);
                    const voices = window.speechSynthesis.getVoices();
                    
                    // Try to find a child-like voice
                    const childVoice = voices.find(voice => 
                        voice.name.includes('Child') || 
                        voice.name.includes('Kids') ||
                        voice.name.includes('Young')
                    );
                    
                    if (childVoice) {
                        utterance.voice = childVoice;
                    } else {
                        // Adjust settings for child-like effect
                        utterance.pitch = 1.8;
                        utterance.rate = 0.9;
                    }
                    
                    window.speechSynthesis.speak(utterance);
                }
                
                setTimeout(() => {
                    speechBubble.classList.remove('show');
                }, duration);
            }

            // Highlight an element with pulsing animation
            function highlightElement(element, duration = 5000) {
                element.classList.add('guidance-highlight');
                setTimeout(() => {
                    element.classList.remove('guidance-highlight');
                }, duration);
            }

            // Show interactive guidance
            function showInteractiveGuidance() {
                // Initial welcome
                setTimeout(() => {
                    tutorSpeak(tutorMessages.welcome);
                }, 1000);

                // Explain profile sections after 3 seconds
                setTimeout(() => {
                    tutorSpeak(tutorMessages.profileDetails);
                    highlightElement(document.querySelector('.details-title'));
                }, 4000);

                // Explain scoreboard after 6 seconds
                setTimeout(() => {
                    tutorSpeak(tutorMessages.scoreboard);
                    highlightElement(document.querySelector('.scoreboard-title'));
                }, 8000);

                // Explain visualization button after 9 seconds
                setTimeout(() => {
                    tutorSpeak(tutorMessages.visualization);
                    highlightElement(document.getElementById('visualizationBtn'));
                }, 12000);

                // Add hover explanations for navigation
                document.querySelectorAll('.nav-links a').forEach(link => {
                    link.addEventListener('mouseenter', function() {
                        const text = this.textContent.trim().toLowerCase();
                        if (text === 'profile') {
                            tutorSpeak(tutorMessages.profileNav);
                        }
                    });
                });

                // Add hover explanation for dashboard button
                document.querySelector('.dashboard-btn').addEventListener('mouseenter', function() {
                    tutorSpeak(tutorMessages.dashboard);
                });

                // Add hover explanation for visualization button
                document.getElementById('visualizationBtn').addEventListener('mouseenter', function() {
                    tutorSpeak(tutorMessages.visualization);
                });
            }

            // Initialize AI Tutor
            function initTutor() {
                // Load voices if needed
                if (window.speechSynthesis.getVoices().length === 0) {
                    window.speechSynthesis.onvoiceschanged = showInteractiveGuidance;
                } else {
                    showInteractiveGuidance();
                }
            }

            try {
                console.log('Fetching profile data for userId:', userId);
                const response = await fetch('/api/profile', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ userId })
                });

                console.log('Response status:', response.status);
                const data = await response.json();
                console.log('Response data:', data);

                if (!response.ok) {
                    throw new Error(data.error || 'Failed to load profile');
                }

                // Update profile details
                document.getElementById('username').textContent = data.username || 'N/A';
                document.getElementById('detail-username').textContent = data.username || 'N/A';
                document.getElementById('detail-standard').textContent = data.standard || 'Not set';
                document.getElementById('detail-age').textContent = data.dob ? calculateAge(data.dob) : 'Not set';
                document.getElementById('detail-school').textContent = data.school_name || 'Not set';
                document.getElementById('detail-medium').textContent = data.medium || 'Not set';

                // Placeholder for subject scores
                const subjectScores = {
                    tamil: { currentScore: 75, lastScore: 60 },
                    english: { currentScore: 82, lastScore: 70 },
                    mathematics: { currentScore: 65, lastScore: 68 }
                };
                renderSubjectScores(subjectScores);

                // Start the tutor after data loads
                initTutor();

                // Show encouragement after scores load
                setTimeout(() => {
                    tutorSpeak(tutorMessages.encouragement);
                }, 15000);

            } catch (error) {
                console.error('Error fetching profile:', error);
                alert('Failed to load profile. Please try again.');
                window.location.href = '/login.html';
            }
        });

        // Function to calculate age from DOB
        function calculateAge(dob) {
            const birthDate = new Date(dob);
            const today = new Date();
            let age = today.getFullYear() - birthDate.getFullYear();
            const monthDiff = today.getMonth() - birthDate.getMonth();
            if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
                age--;
            }
            return age;
        }

        // Function to render subject scores
        function renderSubjectScores(subjects) {
            const container = document.getElementById('subject-scores');
            let html = '';

            for (const [subject, data] of Object.entries(subjects)) {
                html += `
                    <div class="subject-card">
                        <div class="subject-title">${subject.charAt(0).toUpperCase() + subject.slice(1)}</div>
                        <div class="progress-container">
                            <div class="progress-bar" style="width: ${data.currentScore}%"></div>
                        </div>
                        <div class="progress-details">
                            <span>Current: ${data.currentScore}%</span>
                            <span>Last: ${data.lastScore}%</span>
                        </div>
                    </div>
                `;
            }

            container.innerHTML = html;
        }
    </script>
</body>
</html>